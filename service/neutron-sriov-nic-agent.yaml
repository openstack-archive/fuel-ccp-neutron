dsl_version: 0.1.0
service:
  name: neutron-sriov-nic-agent
  kind: DaemonSet
  hostNetwork: true
  containers:
    - name: neutron-sriov-nic-agent
      image: neutron-sriov-nic-agent
      privileged: true
      volumes:
        - name: ovs-socket
          type: host
          path: /run/openvswitch
        - name: modules
          type: host
          path: /lib/modules
      daemon:
        command: neutron-sriov-nic-agent --config-file /etc/neutron/neutron.conf --config-file /etc/neutron/plugins/ml2/sriov_agent.ini
        dependencies:
          - neutron-db-sync
          - "{{ messaging.dependencies[messaging.backend.rpc] }}"
          - "{{ messaging.dependencies[messaging.backend.notifications] }}"
        files:
          - neutron.conf
          - sriov_agent.ini
files:
  neutron.conf:
    path: /etc/neutron/neutron.conf
    content: neutron.conf.j2
    perm: "0600"
  sriov_agent.ini:
    path: /etc/neutron/plugins/ml2/sriov_agent.ini
    content: sriov_agent.ini.j2
    perm: "0600"
