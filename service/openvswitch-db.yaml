dsl_version: 0.1.0
service:
  name: openvswitch-db
  kind: DaemonSet
  hostNetwork: true
  containers:
    - name: openvswitch-db
      image: openvswitch-db
      volumes:
        - name: ovs-socket
          type: host
          path: /run/openvswitch
      pre:
        - name: ovs-bootstrap
          command: /opt/ccp/bin/openvswitch-db-bootstrap.sh
      daemon:
        command: "/usr/sbin/ovsdb-server /etc/openvswitch/conf.db -vconsole:{{ ovs_db.loglevel }} --remote=punix:/run/openvswitch/db.sock --remote=db:Open_vSwitch,Open_vSwitch,manager_options"
        files:
          - openvswitch-db-bootstrap.sh
files:
  openvswitch-db-bootstrap.sh:
    path: /opt/ccp/bin/openvswitch-db-bootstrap.sh
    content: openvswitch-db-bootstrap.sh
    perm: "0755"
