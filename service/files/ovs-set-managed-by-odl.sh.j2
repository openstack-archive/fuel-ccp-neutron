#!/bin/bash

odl_ip={{ service_ip('opendaylight') }}

odl_port={{ opendaylight.ovs_port.cont }}

ovs-vsctl set-manager tcp:$odl_ip:$odl_port

ovs_id=$(ovs-vsctl  get Open_vSwitch . _uuid)
local_ip="{{ network_topology["private"]["address"] }}"
ovs-vsctl set Open_vSwitch $ovs_id other_config:local_ip=$local_ip

ext_iface="{{ network_topology["public"]["iface"] }}"
ovs-vsctl set Open_vSwitch $ovs_id other_config:provider_mappings="br-ex:$ext_iface"
